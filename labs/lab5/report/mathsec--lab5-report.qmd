---
## Author
author:
  name: Тазаева Анастасия Анатольевна
  degrees: BSc
  orcid: 
  email: 1032259385@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Лабораторная работа №5"
subtitle: "Вероятностные алгоритмы проверки чисел на простоту"
license: "CC BY"
---

# Цель работы

Ознакомиться с алгоритмами проверки чисел на простоту. Реализовать их.

# Задание

Реализовать на языке программирования Julia:

1. Алгоритм, реализующий тест Ферма.
2. Алгоритм вычисления числа Якоби.
3. лгоритм, реализующий тест Соловея-Штрассена.
4. Алгоритм, реализующий тест Миллера-Рабина.

# Теоретическое введение

## Алгоритм, реализующий тест Ферма

*Вход*. Нечетное целое число $n>=5$

*Выход*. "Число $n$, вероятно. простое" или "Число $n$ составное"

1. Выбрать случайное целое число $a, 2\leq a\leq n-2.$
2. Вычислить $r=a^{n-1}(modn).$
3. При $r=1$ результат: "Число $n$, вероятно. простое". В противном случае результат: "Число $n$ составное".

## Алгоритм вычисления числа Якоби

*Вход*. Нечетное целое число $n>=3$, целое число $0 \leq a<n$

*Выход*. Символ Якоби $(\frac{a}{n})$

1. Положить $g=1$
2. При $a=0$ результат: $0$
3. При $a=1$ результат: $g$
4. Представить $a$ в виде $a=2^k a_1$, где число $a_1$ нечетное
5. При четном $k$ положить $s=-1$, при нечетном $k$ положить $s=1$, если $n=+-1(mod 8)$; положить $s=-1$, если $n=+-3(mod 8)$  
6. При $a_1=1$ результат: $g\cdot s$
7. Если $n=3(mod4)$ и $a_1=3(mod4)$, то $s=-s$
8.Положить $a=n(mod a_1), n=a_1,g=g \cdot s$ и вернуться на шаг 2.

## Алгоритм, реализующий тест Соловея-Штрассена

*Вход*. Нечетное целое число $n>=5$

*Выход*. "Число $n$, вероятно. простое" или "Число $n$ составное"

1. Выбрать случайное целое число $a, 2\leq a\leq n-2.$
2. Вычислить $r=a^{\frac{n-1}{2}}(modn).$
3. При $r \neq 1$ и $r \neq n-1$ результат: "Число $n$ составное".
4. Вычислить символ Якоби $s=(\frac{a}{n})$
5. При $r=s(mod n)$ результат: "Число $n$ составное". В противном случае результат: "Число $n$, вероятно. простое".

## Алгоритм, реализующий тест Миллера-Рабина

*Вход*. Нечетное целое число $n>=5$

*Выход*. "Число $n$, вероятно. простое" или "Число $n$ составное"

1. Представить $n-1$ в виде $n-1=2^s r$ где число $r$ нечетное.
2. Выбрать случайное целое число $a, 2\leq a\leq n-2.$
3. Вычислить $y=a^r (mod n).$
4. При $y \neq 1$ и $y\neq n-1$ выполнить следующие действия.
  1. Положить $j=1$.
  2. Если $j\leq s-1$ и $y \neq n-1$, то
    1. Положить $y=y^2(mod n)$
    2. При $y=1$ результат: "Число $n$ составное".
    3. Положить $j=j+1$
  3. При $y \neq n-1$ результат: "Число $n$ составное".
5. Результат: "Число $n$, вероятно. простое".

# Выполнение лабораторной работы

## Алгоритм, реализующий тест Ферма

Написан программный код на языке Julia [@doc-julia]:

```Julia
function test_Ferma(n)
    if n < 5
        return "incorrrect n.please try again \n"
    end
    a = rand(2:n-2)
    r = powermod(a, n-1,n)
    if r == 1
        return "4islo " * string(n) * ", veroyatno, prostoe\n"
    else
        return "4islo " * string(n) * " sostavnoe \n"
    end
end
```

Получен следующий результат выполнения программного кода ([рис. @fig-001]).

![Алгоритм, реализующий тест Ферма. Пример отработки](image/ferm.png){#fig-001 width=70%}

## Алгоритм вычисления числа Якоби

Написан программный код на языке Julia [@doc-julia]:

```Julia
function simvol_Yakobi(n,a)
    if n < 3 || a >= n || a < 0
        return "\nincorrrect n,a.please try again\n"
    end
    g = 1
    a1 = 0
    k = 0
    s = 0
    while a1 != 1
        if 1 == 0
            return 0
        elseif a == 1
            return 1
        end
        a1 = a
        k = 0
        while a1 % 2 == 0
            k += 1
            a1 = round(Int64, a1 / 2)
        end
        if k % 2 == 0 || (k % 2 == 1 && \\
        (n % 8 == 1 || n %8 == 7))
            s = 1
        elseif k % 2 == 1 && (n % 8 == 3 || n % 8 == 5)
            s = -1
        end
        if a1 == 1
            return g*s
        end
        if n%4==3 && a%4==3
            s=-s
        end
        a = n % a1
        n = a1
        g *= s
    end
end
```

Получен следующий результат выполнения программного кода ([рис. @fig-002]).

![Алгоритм вычисления числа Якоби. Пример отработки](image/simvol_yakobi.png){#fig-002 width=70%}

## Алгоритм, реализующий тест Соловея-Штрассена

Написан программный код на языке Julia [@doc-julia]:

```Julia
function test_Soloveya_Shtrassena(n)
    if n < 5
        return "incorrrect n.please try again"
    end
    a = rand(2:n-2)
    r = powermod(a, round(Int64, (n-1)/2), n)
    if r != 1 && r != n-1
        return "4islo " * string(n) * " sostavnoe \n"
    else
        s = simvol_Yakobi(n,a)
        if r == s && r != NaN
            return "4islo " * string(n) * " sostavnoe \n"
        end
        return "4islo " * string(n) * ", veroyatno, prostoe\n"
    end
end	
```

Получен следующий результат выполнения программного кода ([рис. @fig-003]).

![Алгоритм, реализующий тест Соловея-Штрассена. Пример отработки](image/solovey.png){#fig-003 width=70%}

## Алгоритм, реализующий тест Миллера-Рабина

Написан программный код на языке Julia [@doc-julia]:

```Julia
function test_Millera_Robina(n)
    if n < 5
        return "Incorrect input."
    end
    r = n-1
    s = 0
    while r % 2 == 0
        s += 1
        r = round(Int64, r / 2)
    end
    a = rand(2:n-2)
    y = powermod(a, r, n)
    if y != 1 && y != n-1
        j = 1
        while j < s-1 && y != n-1
            y = y^2 % n
            if y == 1
                "4islo " * string(n) * " sostavnoe \n"
            end
            j += 1
        end
        if y != n-1
            "4islo " * string(n) * " sostavnoe \n"
        else
            "4islo " * string(n) * ", veroyatno, prostoe\n"
        end
    else
        return "4islo " * string(n) * ", veroyatno, prostoe\n"
    end
end
```

Получен следующий результат выполнения программного кода ([рис. @fig-004]).

![Алгоритм, реализующий тест Миллера-Рабина. Пример отработки](image/miller_rabin.png){#fig-004 width=70%}

# Выводы

В ходе лабораторной работы реализованы на языке программирования Julia:

1. Алгоритм, реализующий тест Ферма.
2. Алгоритм вычисления числа Якоби.
3. Алгоритм, реализующий тест Соловея-Штрассена.
4. Алгоритм, реализующий тест Миллера-Рабина.

# Список литературы{.unnumbered}

::: {#refs}
:::
